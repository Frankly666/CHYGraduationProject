import{r as e,R as l,T as t,G as a,K as o,D as s,o as n,c as r,w as c,a as i,d as u,F as d,e as p,B as f,b as m,t as g,E as v,q as y,v as h,s as _,O as k,g as b,x as w,n as x,i as $,j as C,I as S,k as j,y as I,U as T,V as D,W as O,J as P,X as E}from"./index-E3agI9Tn.js";import{m as A,r as z,_ as N}from"./marked.esm.CWmrkk8-.js";import{e as F}from"./pdf-export.BKZ-eH5L.js";import{c as J}from"./research-plan.CgVzqYui.js";import{_ as V}from"./_plugin-vue_export-helper.BCo6x5W8.js";const B="sk-JWuFVaV252ndCTXc3Q8lvkVP7vMomFeySnJxx6bbT1PMoEst",M=V({__name:"ResearchPlanGenerator",props:{graphData:{type:Object,default:null},embedded:{type:Boolean,default:!1}},emits:["complete","cancel"],setup(E,{emit:V}){const M=E,H=[{title:"åŸºæœ¬ä¿¡æ¯"},{title:"æ–¹æ¡ˆæ¡†æ¶"},{title:"å®Œæ•´æ–¹æ¡ˆ"}],L=e(0),R=l({topic:"",objective:"",keywords:[],templateType:"experimental"}),U=e(null!==M.graphData),W=e(""),q=e=>{if(console.log("å…³é”®è¯è¾“å…¥å˜åŒ–:",W.value),W.value.includes(",")){const e=W.value.split(",").map((e=>e.trim())).filter((e=>e));console.log("æ·»åŠ å…³é”®è¯æ•°ç»„:",e),R.keywords.push(...e),W.value="",le()}},G=()=>{if(console.log("å…³é”®è¯è¾“å…¥æ¡†å¤±ç„¦:",W.value),W.value.trim()){const e=W.value.trim();console.log("å¤±ç„¦æ·»åŠ å…³é”®è¯:",e),R.keywords.push(e),W.value="",le()}},X=e=>{if(console.log("å…³é”®è¯è¾“å…¥ç¡®è®¤:",W.value),W.value.trim()){const e=W.value.trim();console.log("ç¡®è®¤æ·»åŠ å…³é”®è¯:",e),R.keywords.push(e),W.value="",le()}},Y=["å®éªŒç ”ç©¶","è°ƒæŸ¥ç ”ç©¶","æ¡ˆä¾‹ç ”ç©¶","æ–‡çŒ®ç»¼è¿°","è¡ŒåŠ¨ç ”ç©¶"],K=e(0),Q=["experimental","survey","case-study","literature-review","action-research"],Z=e=>{K.value=e.detail.value,R.templateType=Q[e.detail.value],le()},ee=e(!1),le=()=>{console.log("éªŒè¯è¡¨å•:",R),ee.value=!!R.topic&&!!R.objective&&R.keywords.length>0,console.log("éªŒè¯ç»“æœ:",ee.value)};t((()=>R.topic),(()=>le())),t((()=>R.objective),(()=>le()));const te=e=>{U.value=e.detail.value},ae=async()=>{var e,l;try{if(0===L.value){if(y({title:"æ­£åœ¨ç”Ÿæˆæ¡†æ¶...",mask:!0}),console.log("å¼€å§‹ç”Ÿæˆæ¡†æ¶ï¼Œè¡¨å•æ•°æ®:",R),!ee.value)return h(),void _({title:"è¯·å®Œæˆæ‰€æœ‰å¿…å¡«é¡¹",icon:"none"});if(await re(),!ne.value||ne.value.error&&!Object.keys(ne.value).some((e=>e.startsWith("section"))))return h(),void k({title:"ç”Ÿæˆå¤±è´¥",content:(null==(e=ne.value)?void 0:e.error)||"ç”Ÿæˆæ¡†æ¶å¤±è´¥ï¼Œè¯·é‡è¯•",showCancel:!1});h()}else if(1===L.value){if(y({title:"æ­£åœ¨ç”Ÿæˆå®Œæ•´æ–¹æ¡ˆ...",mask:!0}),await ve(),!ge.value||ge.value.error)return h(),void k({title:"ç”Ÿæˆå¤±è´¥",content:(null==(l=ge.value)?void 0:l.error)||"ç”Ÿæˆæ–¹æ¡ˆå†…å®¹å¤±è´¥ï¼Œè¯·é‡è¯•",showCancel:!1});h()}L.value<H.length-1&&L.value++}catch(t){console.error("æ­¥éª¤åˆ‡æ¢å¤±è´¥:",t),h(),_({title:"æ“ä½œå¤±è´¥: "+t.message,icon:"none"})}},oe=()=>{L.value>0&&L.value--},se=e(!1),ne=e(null),re=async()=>{try{se.value=!0;const e=await(async e=>{var l;try{if(console.log("å¼€å§‹ç”Ÿæˆç ”ç©¶æ–¹æ¡ˆæ¡†æ¶ï¼Œå‚æ•°:",JSON.stringify(e)),!e.topic||!e.objective||!e.keywords||0===e.keywords.length)throw console.error("ç”Ÿæˆç ”ç©¶æ–¹æ¡ˆæ¡†æ¶å‚æ•°ä¸å®Œæ•´:",e),new Error("å‚æ•°ä¸å®Œæ•´ï¼Œè¯·ç¡®ä¿å¡«å†™äº†ç ”ç©¶ä¸»é¢˜ã€ç›®æ ‡å’Œè‡³å°‘ä¸€ä¸ªå…³é”®è¯");const n=[{role:"system",content:"ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æ•™è‚²ç ”ç©¶æ–¹æ¡ˆç”ŸæˆåŠ©æ‰‹ã€‚è¯·åŸºäºç”¨æˆ·æä¾›çš„ç ”ç©¶ä¸»é¢˜ã€ç›®æ ‡å’Œå…³é”®è¯ï¼Œ\nç”Ÿæˆä¸€ä¸ªç§‘å­¦åˆç†çš„ç ”ç©¶æ–¹æ¡ˆæ¡†æ¶ã€‚æ¡†æ¶åº”åŒ…æ‹¬ä»¥ä¸‹éƒ¨åˆ†ï¼š\n1. ç ”ç©¶èƒŒæ™¯ä¸æ„ä¹‰\n2. ç ”ç©¶ç›®æ ‡å’Œé—®é¢˜\n3. æ–‡çŒ®ç»¼è¿°æ¦‚è¦\n4. ç ”ç©¶æ–¹æ³•é€‰æ‹©\n5. æ•°æ®æ”¶é›†æ–¹æ¡ˆ\n6. æ•°æ®åˆ†ææ–¹æ³•\n7. é¢„æœŸç ”ç©¶æˆæœ\n8. Iå®æ–½è®¡åˆ’å’Œæ—¶é—´è¡¨\n\nè¯·ç¡®ä¿ç ”ç©¶æ–¹æ¡ˆæ¡†æ¶ç¬¦åˆå­¦æœ¯è§„èŒƒï¼Œå¹¶å…·æœ‰å¯æ“ä½œæ€§ã€‚æ ¹æ®ç ”ç©¶ä¸»é¢˜å’Œç›®æ ‡çš„ç‰¹ç‚¹ï¼Œè°ƒæ•´æ¡†æ¶å†…å®¹ã€‚"},{role:"user",content:`è¯·æ ¹æ®ä»¥ä¸‹ä¿¡æ¯ç”Ÿæˆæ•™è‚²ç ”ç©¶æ–¹æ¡ˆæ¡†æ¶ï¼š\nç ”ç©¶ä¸»é¢˜ï¼š${e.topic}\nç ”ç©¶ç›®æ ‡ï¼š${e.objective}\nå…³é”®è¯ï¼š${e.keywords.join("ã€")}\næ–¹æ¡ˆç±»å‹ï¼š${e.templateType}\n\nè¯·ä»…ç”Ÿæˆæ¡†æ¶ç»“æ„ï¼Œä¸éœ€è¦è¯¦ç»†å†…å®¹ã€‚è¿”å›JSONæ ¼å¼ï¼ŒåŒ…å«æ¯ä¸ªç« èŠ‚çš„æ ‡é¢˜å’Œç®€çŸ­è¯´æ˜ã€‚`}];console.log("å‡†å¤‡å‘é€APIè¯·æ±‚...");const r={model:"moonshot-v1-32k",messages:n,temperature:.3};console.log("è¯·æ±‚ä½“:",JSON.stringify(r));try{const e=await fetch("https://api.moonshot.cn/v1/chat/completions",{method:"POST",headers:{Authorization:`Bearer ${B}`,"Content-Type":"application/json"},body:JSON.stringify(r)});if(!e.ok){const a=await e.text();let o;console.error("APIå“åº”é”™è¯¯:",{status:e.status,statusText:e.statusText,responseText:a});try{o=JSON.parse(a)}catch(t){o={error:{message:a||"æœªçŸ¥é”™è¯¯"}}}throw new Error((null==(l=null==o?void 0:o.error)?void 0:l.message)||`APIè¯·æ±‚å¤±è´¥: ${e.status} ${e.statusText}`)}const s=await e.json();console.log("ç”Ÿæˆç ”ç©¶æ–¹æ¡ˆæ¡†æ¶æˆåŠŸ, çŠ¶æ€:",e.status);try{if(!(s.choices&&s.choices[0]&&s.choices[0].message&&s.choices[0].message.content))throw console.error("APIè¿”å›ç»“æœæ ¼å¼ä¸æ­£ç¡®:",s),new Error("APIè¿”å›ç»“æœæ ¼å¼ä¸æ­£ç¡®");const e=s.choices[0].message.content;console.log("AIè¿”å›çš„åŸå§‹æ•°æ®é•¿åº¦:",e.length,"å­—ç¬¦");const l=e.match(/\{[\s\S]*\}/),t=l?l[0]:e;console.log("æå–çš„JSONæ–‡æœ¬:",t.substring(0,100)+"...");try{const e=JSON.parse(t);return console.log("è§£ææˆåŠŸï¼ŒåŒ…å«ç« èŠ‚æ•°:",Object.keys(e).length),e}catch(a){return console.error("JSONè§£æå¤±è´¥ï¼Œå°è¯•åŒ…è£…ä¸ºæœ‰æ•ˆJSONæ ¼å¼"),{error:null,section1:{title:"ç ”ç©¶èƒŒæ™¯ä¸æ„ä¹‰",description:"æè¿°ç ”ç©¶çš„èƒŒæ™¯ã€æ„ä¹‰å’Œç°å®éœ€æ±‚ã€‚"},section2:{title:"ç ”ç©¶ç›®æ ‡å’Œé—®é¢˜",description:"æ˜ç¡®ç ”ç©¶ç›®æ ‡å’Œå¾…è§£å†³çš„ä¸»è¦é—®é¢˜ã€‚"},section3:{title:"æ–‡çŒ®ç»¼è¿°",description:"ç›¸å…³ç ”ç©¶æ–‡çŒ®å’Œç†è®ºåŸºç¡€çš„æ¦‚è¿°ã€‚"},section4:{title:"ç ”ç©¶æ–¹æ³•",description:"ç ”ç©¶é‡‡ç”¨çš„æ–¹æ³•å’Œæ­¥éª¤ã€‚"},section5:{title:"æ•°æ®æ”¶é›†æ–¹æ¡ˆ",description:"æ•°æ®æ”¶é›†çš„æ–¹å¼ã€å·¥å…·å’Œè¿‡ç¨‹ã€‚"},section6:{title:"æ•°æ®åˆ†ææ–¹æ³•",description:"æ•°æ®å¤„ç†å’Œåˆ†æçš„æ–¹æ³•ã€‚"},section7:{title:"é¢„æœŸç ”ç©¶æˆæœ",description:"ç ”ç©¶å¯èƒ½äº§ç”Ÿçš„æˆæœå’Œä»·å€¼ã€‚"},section8:{title:"å®æ–½è®¡åˆ’",description:"ç ”ç©¶çš„å…·ä½“å®æ–½è®¡åˆ’å’Œæ—¶é—´è¡¨ã€‚"},rawContent:e}}}catch(o){return console.error("è§£æAIè¿”å›ç»“æœå¤±è´¥:",o),{error:"è§£æè¿”å›ç»“æœå¤±è´¥",rawContent:s.choices[0].message.content,section1:{title:"ç ”ç©¶èƒŒæ™¯ä¸æ„ä¹‰",description:"æè¿°ç ”ç©¶çš„èƒŒæ™¯ã€æ„ä¹‰å’Œç°å®éœ€æ±‚ã€‚"},section2:{title:"ç ”ç©¶ç›®æ ‡å’Œé—®é¢˜",description:"æ˜ç¡®ç ”ç©¶ç›®æ ‡å’Œå¾…è§£å†³çš„ä¸»è¦é—®é¢˜ã€‚"}}}}catch(s){return console.error("APIè¯·æ±‚é”™è¯¯:",s),{error:`APIè¯·æ±‚é”™è¯¯: ${s.message}`,section1:{title:"ç ”ç©¶èƒŒæ™¯ä¸æ„ä¹‰",description:"æè¿°ç ”ç©¶çš„èƒŒæ™¯ã€æ„ä¹‰å’Œç°å®éœ€æ±‚ã€‚"},section2:{title:"ç ”ç©¶ç›®æ ‡å’Œé—®é¢˜",description:"æ˜ç¡®ç ”ç©¶ç›®æ ‡å’Œå¾…è§£å†³çš„ä¸»è¦é—®é¢˜ã€‚"}}}}catch(n){return console.error("ç”Ÿæˆç ”ç©¶æ–¹æ¡ˆæ¡†æ¶å¤±è´¥:",n),{error:`ç”Ÿæˆæ¡†æ¶å¤±è´¥: ${n.message}`,section1:{title:"ç ”ç©¶èƒŒæ™¯ä¸æ„ä¹‰",description:"æè¿°ç ”ç©¶çš„èƒŒæ™¯ã€æ„ä¹‰å’Œç°å®éœ€æ±‚ã€‚"},section2:{title:"ç ”ç©¶ç›®æ ‡å’Œé—®é¢˜",description:"æ˜ç¡®ç ”ç©¶ç›®æ ‡å’Œå¾…è§£å†³çš„ä¸»è¦é—®é¢˜ã€‚"}}}})({topic:R.topic,objective:R.objective,keywords:R.keywords,templateType:R.templateType});ne.value=e}catch(e){console.error("ç”Ÿæˆæ¡†æ¶å¤±è´¥:",e),ne.value={error:"ç”Ÿæˆæ¡†æ¶å¤±è´¥: "+e.message}}finally{se.value=!1}},ce=e(null),ie=e(null),ue=e(""),de=e(""),pe=()=>{ce.value.close()},fe=()=>{ie.value&&ne.value&&(ne.value[ie.value]={title:ue.value,description:de.value}),ce.value.close()},me=e(!1),ge=e({content:"",framework:null}),ve=async()=>{try{me.value=!0;const e=U.value?M.graphData:null,l=await(async(e,l,t=null)=>{var a;try{console.log("å¼€å§‹å¡«å……ç ”ç©¶æ–¹æ¡ˆå†…å®¹");const o=[{role:"system",content:"ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æ•™è‚²ç ”ç©¶æ–¹æ¡ˆç”ŸæˆåŠ©æ‰‹ã€‚ç°åœ¨ç”¨æˆ·æä¾›äº†ä¸€ä¸ªç ”ç©¶æ–¹æ¡ˆæ¡†æ¶ï¼Œè¯·åŸºäºè¿™ä¸ªæ¡†æ¶å’Œç›¸å…³çŸ¥è¯†ï¼Œ\nå¡«å……ç”Ÿæˆä¸€ä¸ªå®Œæ•´çš„æ•™è‚²ç ”ç©¶æ–¹æ¡ˆã€‚å†…å®¹åº”åŒ…æ‹¬è¯¦ç»†çš„ç ”ç©¶æ–¹æ³•ã€å®æ–½æ­¥éª¤ã€æ•°æ®åˆ†ææ–¹æ³•ç­‰ã€‚è¯·ç¡®ä¿å†…å®¹ç§‘å­¦åˆç†ï¼Œ\nç¬¦åˆæ•™è‚²ç ”ç©¶çš„è§„èŒƒï¼Œå¹¶å…·æœ‰å¯æ“ä½œæ€§ã€‚"},{role:"user",content:`è¯·æ ¹æ®ä»¥ä¸‹æ¡†æ¶å’Œä¿¡æ¯ï¼Œç”Ÿæˆå®Œæ•´çš„æ•™è‚²ç ”ç©¶æ–¹æ¡ˆï¼š\nç ”ç©¶ä¸»é¢˜ï¼š${l.topic}\nç ”ç©¶ç›®æ ‡ï¼š${l.objective}\nå…³é”®è¯ï¼š${l.keywords.join("ã€")}\n\nç ”ç©¶æ–¹æ¡ˆæ¡†æ¶ï¼š\n${JSON.stringify(e,null,2)}\n\n${t?`ç›¸å…³çŸ¥è¯†å›¾è°±æ•°æ®ï¼š${JSON.stringify(t,null,2)}`:""}\n\nè¯·ä¸ºæ¯ä¸ªç« èŠ‚å¡«å……å…·ä½“å†…å®¹ï¼Œå†…å®¹åº”ç§‘å­¦åˆç†ï¼Œè¯¦ç»†å¯è¡Œã€‚è¿”å›å®Œæ•´çš„ç ”ç©¶æ–¹æ¡ˆï¼Œæ ¼å¼ä¸ºMarkdownã€‚`}],s=await fetch("https://api.moonshot.cn/v1/chat/completions",{method:"POST",headers:{Authorization:`Bearer ${B}`,"Content-Type":"application/json"},body:JSON.stringify({model:"moonshot-v1-32k",messages:o,temperature:.4})});if(!s.ok){const e=await s.json();throw console.error("å¡«å……ç ”ç©¶æ–¹æ¡ˆå†…å®¹é”™è¯¯:",e),new Error((null==(a=null==e?void 0:e.error)?void 0:a.message)||"å¡«å……ç ”ç©¶æ–¹æ¡ˆå†…å®¹å¤±è´¥")}const n=await s.json();return console.log("å¡«å……ç ”ç©¶æ–¹æ¡ˆå†…å®¹æˆåŠŸ"),{content:n.choices[0].message.content,framework:e}}catch(o){throw console.error("å¡«å……ç ”ç©¶æ–¹æ¡ˆå†…å®¹å¤±è´¥:",o),o}})(ne.value,R,e);ge.value=l}catch(e){console.error("ç”Ÿæˆå®Œæ•´æ–¹æ¡ˆå¤±è´¥:",e),ge.value={error:"ç”Ÿæˆå®Œæ•´æ–¹æ¡ˆå¤±è´¥: "+e.message}}finally{me.value=!1}},ye=a((()=>{if(!ge.value.content)return"";try{console.log("åŸå§‹å†…å®¹å‰50ä¸ªå­—ç¬¦:",ge.value.content.substring(0,50));let e=ge.value.content;e=e.replace(/^[\s`]{0,3}markdown#?.*?\n/i,""),e=e.replace(/```markdown#?/gi,""),e=e.replace(/```\w*/gi,""),e=e.replace(/```/g,""),e=e.replace(/^['"`]|['"`]$/g,""),e=e.replace(/^(#{1,6})([^\s])/gm,"$1 $2"),e=e.replace(/^([*\-+])([^\s])/gm,"$1 $2"),e=e.replace(/^(\d+\.)([^\s])/gm,"$1 $2"),e=e.replace(/\n([^#\s\-\*\d])/g,"\n\n$1").replace(/([^\n])\n(#{1,6})/g,"$1\n\n$2").replace(/\n([*\-+])/g,"\n\n$1").replace(/\n{3,}/g,"\n\n"),console.log("é¢„å¤„ç†åå†…å®¹å‰50ä¸ªå­—ç¬¦:",e.substring(0,50)),console.log("é¢„å¤„ç†åå†…å®¹é•¿åº¦:",e.length),A.setOptions({gfm:!0,breaks:!0,headerIds:!0,mangle:!1,pedantic:!1,sanitize:!1,smartLists:!0,smartypants:!0});const l=A(e);return console.log("HTMLæ¸²æŸ“åé•¿åº¦:",l.length),l.replace(/<h1/g,'<h1 class="plan-h1"').replace(/<h2/g,'<h2 class="plan-h2"').replace(/<h3/g,'<h3 class="plan-h3"').replace(/<h4/g,'<h4 class="plan-h4"').replace(/<h5/g,'<h5 class="plan-h5"').replace(/<h6/g,'<h6 class="plan-h6"').replace(/<p>/g,'<p class="plan-p">').replace(/<ul>/g,'<ul class="plan-ul">').replace(/<ol>/g,'<ol class="plan-ol">').replace(/<li>/g,'<li class="plan-li">').replace(/<pre>/g,'<pre class="plan-pre">').replace(/<code>/g,'<code class="plan-code">')}catch(e){return console.error("Markdownæ¸²æŸ“å¤±è´¥:",e),`<pre style="white-space: pre-wrap; word-wrap: break-word; padding: 16px; background: #f5f5f5; border-radius: 4px; font-family: monospace;">${ge.value.content.replace(/```markdown#?|```\s*\w*|```/g,"").replace(/^['"]+|['"]+$/g,"").replace(/</g,"&lt;").replace(/>/g,"&gt;")}</pre>`}})),he=[{label:"æ–¹æ³•è®ºä¼˜åŒ–",value:"methodology"},{label:"æ–‡çŒ®å¼•ç”¨å¢å¼º",value:"literature"},{label:"å¯è¡Œæ€§æå‡",value:"feasibility"},{label:"åˆ›æ–°æ€§å¢å¼º",value:"innovation"}],_e=e(""),ke=e(!1),be=async()=>{if(_e.value&&ge.value.content)try{ke.value=!0;const e=await(async(e,l)=>{var t;try{console.log("å¼€å§‹ä¼˜åŒ–ç ”ç©¶æ–¹æ¡ˆ:",l);const a=[{role:"system",content:"ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æ•™è‚²ç ”ç©¶æ–¹æ¡ˆä¼˜åŒ–åŠ©æ‰‹ã€‚è¯·æ ¹æ®ç”¨æˆ·æä¾›çš„ç ”ç©¶æ–¹æ¡ˆå†…å®¹å’Œä¼˜åŒ–é‡ç‚¹ï¼Œ\nå¯¹ç ”ç©¶æ–¹æ¡ˆè¿›è¡Œä¼˜åŒ–å’Œæ”¹è¿›ã€‚ä¼˜åŒ–åº”è¯¥ä¿æŒæ–¹æ¡ˆçš„æ•´ä½“ç»“æ„ï¼ŒåŒæ—¶æå‡å†…å®¹çš„ç§‘å­¦æ€§ã€å¯è¡Œæ€§å’Œåˆ›æ–°æ€§ã€‚"},{role:"user",content:`è¯·ä¼˜åŒ–ä»¥ä¸‹ç ”ç©¶æ–¹æ¡ˆï¼Œé‡ç‚¹å…³æ³¨${l.focus}æ–¹é¢ï¼š\n\n${e}\n\nè¯·åœ¨ä¿æŒåŸæ–¹æ¡ˆç»“æ„çš„åŸºç¡€ä¸Šï¼Œæé«˜æ–¹æ¡ˆçš„è´¨é‡ã€‚è¿”å›å®Œæ•´çš„ä¼˜åŒ–åæ–¹æ¡ˆï¼Œæ ¼å¼ä¸ºMarkdownã€‚`}],o=await fetch("https://api.moonshot.cn/v1/chat/completions",{method:"POST",headers:{Authorization:`Bearer ${B}`,"Content-Type":"application/json"},body:JSON.stringify({model:"moonshot-v1-32k",messages:a,temperature:.3})});if(!o.ok){const e=await o.json();throw console.error("ä¼˜åŒ–ç ”ç©¶æ–¹æ¡ˆé”™è¯¯:",e),new Error((null==(t=null==e?void 0:e.error)?void 0:t.message)||"ä¼˜åŒ–ç ”ç©¶æ–¹æ¡ˆå¤±è´¥")}const s=await o.json();return console.log("ä¼˜åŒ–ç ”ç©¶æ–¹æ¡ˆæˆåŠŸ"),s.choices[0].message.content}catch(a){throw console.error("ä¼˜åŒ–ç ”ç©¶æ–¹æ¡ˆå¤±è´¥:",a),a}})(ge.value.content,{focus:_e.value});ge.value={...ge.value,content:e}}catch(e){console.error("ä¼˜åŒ–æ–¹æ¡ˆå¤±è´¥:",e),_({title:"ä¼˜åŒ–æ–¹æ¡ˆå¤±è´¥: "+e.message,icon:"none"})}finally{ke.value=!1}},we=e(!1),xe=e(null),$e=async()=>{try{if(we.value=!0,y({title:"æ­£åœ¨ç”ŸæˆPDF...",mask:!0}),"undefined"==typeof document)throw new Error("å½“å‰ä¸æ˜¯Webç¯å¢ƒï¼Œæ— æ³•å¯¼å‡ºPDF");console.log("å‡†å¤‡å¯¼å‡ºPDF...");const a=document.createElement("div");a.className="plan-display export-container",a.style.width="100%",a.style.fontFamily="PingFang SC, Microsoft YaHei, sans-serif",a.style.backgroundColor="#ffffff",a.style.boxSizing="border-box",a.style.padding="30px",a.style.lineHeight="1.6",a.style.color="#333333";const o=document.createElement("div");o.className="plan-header",o.style.textAlign="center",o.style.marginBottom="30px";const s=document.createElement("div");s.className="plan-title",s.textContent=R.topic,s.style.fontSize="26px",s.style.fontWeight="bold",s.style.marginBottom="15px",o.appendChild(s);const n=document.createElement("div");n.className="plan-meta",n.textContent=`å…³é”®è¯: ${R.keywords.join("ã€")}`,n.style.fontSize="14px",n.style.color="#666",o.appendChild(n);const r=document.createElement("div");r.style.marginTop="20px",r.style.marginBottom="30px",r.style.padding="15px",r.style.backgroundColor="#f8f9fa",r.style.borderRadius="6px",r.style.textAlign="left";const c=document.createElement("div");c.textContent="ç ”ç©¶ç›®æ ‡:",c.style.fontWeight="bold",c.style.marginBottom="8px",r.appendChild(c);const i=document.createElement("div");i.textContent=R.objective||"æ— ",i.style.color="#333",r.appendChild(i),o.appendChild(r),a.appendChild(o);const u=document.createElement("div");u.className="plan-content",u.style.fontSize="15px",u.style.lineHeight="1.6",u.style.textAlign="left";try{u.innerHTML=(e=>{if(!e)return"";try{A.setOptions({gfm:!0,breaks:!0,headerIds:!0,mangle:!1,pedantic:!1,sanitize:!1,smartLists:!0,smartypants:!0});let l=e;l=l.replace(/^[\s`]{0,3}markdown#?.*?\n/i,""),l=l.replace(/```markdown#?/gi,""),l=l.replace(/```\w*/gi,""),l=l.replace(/```/g,""),l=l.replace(/^['"`]|['"`]$/g,""),l=l.replace(/^(#{1,6})([^\s])/gm,"$1 $2"),l=l.replace(/^([*\-+])([^\s])/gm,"$1 $2"),l=l.replace(/^(\d+\.)([^\s])/gm,"$1 $2"),l=l.replace(/\n([^#\s\-\*\d])/g,"\n\n$1").replace(/([^\n])\n(#{1,6})/g,"$1\n\n$2").replace(/\n([*\-+])/g,"\n\n$1").replace(/\n{3,}/g,"\n\n");return A(l).replace(/<h1/g,'<h1 style="font-size:24px;font-weight:bold;margin:24px 0 16px;color:#333;border-bottom:1px solid #eee;padding-bottom:8px;"').replace(/<h2/g,'<h2 style="font-size:20px;font-weight:bold;margin:20px 0 14px;color:#333;"').replace(/<h3/g,'<h3 style="font-size:18px;font-weight:bold;margin:18px 0 12px;color:#333;"').replace(/<h4/g,'<h4 style="font-size:16px;font-weight:bold;margin:16px 0 10px;color:#333;"').replace(/<h5/g,'<h5 style="font-size:14px;font-weight:bold;margin:14px 0 8px;color:#333;"').replace(/<h6/g,'<h6 style="font-size:13px;font-weight:bold;margin:12px 0 6px;color:#333;"').replace(/<p>/g,'<p style="margin:12px 0;line-height:1.6;color:#333;">').replace(/<ul>/g,'<ul style="margin:12px 0;padding-left:24px;">').replace(/<ol>/g,'<ol style="margin:12px 0;padding-left:24px;">').replace(/<li>/g,'<li style="margin:6px 0;line-height:1.5;">').replace(/<pre/g,'<pre style="background-color:#f5f5f5;padding:12px;border-radius:5px;overflow-x:auto;margin:16px 0;"').replace(/<code/g,'<code style="background-color:#f0f0f0;padding:2px 4px;border-radius:3px;font-family:monospace;font-size:0.9em;"')}catch(l){return console.error("Markdownè½¬HTMLå¤±è´¥:",l),`<div style="white-space:pre-wrap;padding:16px;background:#f5f5f5;border-radius:4px;font-family:monospace;line-height:1.5;">${e.replace(/```markdown#?|```\s*\w*|```/g,"").replace(/^['"]+|['"]+$/g,"").replace(/</g,"&lt;").replace(/>/g,"&gt;")}</div>`}})(ge.value.content)}catch(e){console.error("Markdownè½¬HTMLå¤±è´¥:",e);let l=ge.value.content.replace(/```markdown#?|```\s*\w*|```/g,"").replace(/^['"]+|['"]+$/g,"").replace(/</g,"&lt;").replace(/>/g,"&gt;");u.innerHTML=`<pre style="white-space: pre-wrap; word-wrap: break-word; padding: 16px; background: #f5f5f5; border-radius: 4px; font-family: monospace;">${l}</pre>`}Array.from(u.querySelectorAll("h1, h2, h3, h4, h5, h6")).forEach((e=>{e.style.pageBreakAfter="avoid",e.style.pageBreakBefore="auto"})),Array.from(u.querySelectorAll("p")).forEach((e=>{e.style.pageBreakInside="avoid"})),Array.from(u.querySelectorAll("ul, ol")).forEach((e=>{e.style.pageBreakInside="auto"})),a.appendChild(u);const d=document.createElement("div");d.className="plan-footer",d.style.marginTop="40px",d.style.paddingTop="15px",d.style.borderTop="1px solid #f0f0f0",d.style.textAlign="center",d.style.fontSize="12px",d.style.color="#999";const p=document.createElement("div");p.textContent=`ç”Ÿæˆæ—¶é—´: ${Ie(new Date)}`,d.appendChild(p);const f=document.createElement("div");f.textContent="ç”±EduResearchæ™ºèƒ½æ•™è‚²ç ”ç©¶åŠ©æ‰‹ç”Ÿæˆ",d.appendChild(f),a.appendChild(d),console.log("å¯¼å‡ºå†…å®¹å‡†å¤‡å®Œæˆ");try{console.log("æ·»åŠ å…ƒç´ åˆ°DOMå¹¶å‡†å¤‡å¯¼å‡º..."),a.style.position="fixed",a.style.top="0",a.style.left="0",a.style.width="210mm",a.style.maxWidth="210mm",a.style.padding="20mm 20mm",a.style.boxSizing="border-box",a.style.zIndex="-1000",document.body.appendChild(a),await new Promise((e=>setTimeout(e,1e3)));const e=`${R.topic.substring(0,20)}_ç ”ç©¶æ–¹æ¡ˆ.pdf`;console.log("å‡†å¤‡å¯¼å‡ºPDFï¼Œæ–‡ä»¶å:",e);const l=await F({element:a,filename:e,title:R.topic,author:"æ•™è‚²ç ”ç©¶åŠ©æ‰‹",margins:{top:15,right:15,bottom:20,left:15},pageSize:"a4"});if(h(),!l.success)throw new Error(l.message);_({title:"å¯¼å‡ºæˆåŠŸ",icon:"success",duration:2e3})}catch(l){throw console.error("PDFå¯¼å‡ºå¤±è´¥:",l),l}finally{if(document.body.contains(a))try{document.body.removeChild(a),console.log("ä¸´æ—¶å¯¼å‡ºå…ƒç´ å·²ç§»é™¤")}catch(t){console.error("ç§»é™¤ä¸´æ—¶å…ƒç´ å¤±è´¥:",t)}}}catch(l){console.error("å¯¼å‡ºPDFè¿‡ç¨‹ä¸­å‡ºé”™:",l),h(),k({title:"å¯¼å‡ºå¤±è´¥",content:`æ— æ³•å¯¼å‡ºPDF: ${l.message}ã€‚æ‚¨å¯ä»¥å°è¯•åˆ·æ–°é¡µé¢åé‡è¯•ï¼Œæˆ–å¤åˆ¶å†…å®¹åˆ°å…¶ä»–æ–‡æ¡£å·¥å…·ä¸­ã€‚`,showCancel:!1})}finally{we.value=!1}},Ce=async()=>{try{const l=b("isLogIn"),t=b("userId");if(!l||!t)return void _({title:"è¯·å…ˆç™»å½•å†ä¿å­˜",icon:"none"});y({title:"æ­£åœ¨ä¿å­˜...",mask:!0});const a=(e,l=500)=>null==e?"":("string"!=typeof e&&(e=String(e)),e.replace(/[\x00-\x1F\x7F-\x9F]/g,"").replace(/[\uD800-\uDFFF]/g,"").replace(/[^\u0000-\u00ff\u4e00-\u9fa5]/g,"").slice(0,l)),o=e=>Array.isArray(e)?e.map((e=>a(e,50))).filter((e=>e.length>0)).slice(0,10):[],s=e=>{if(!e)return"{}";try{const l={};Object.keys(e).forEach((t=>{"object"==typeof e[t]&&null!==e[t]&&e[t].title&&(l[t]={title:a(e[t].title,100),description:a(e[t].description,500)})}));const t=JSON.stringify(l);return JSON.parse(t),t}catch(l){return console.error("æ¡†æ¶å¯¹è±¡è½¬JSONå¤±è´¥:",l),"{}"}},n={title:a(R.topic,100),topic:a(R.topic,100),objective:a(R.objective,500),keywords:o(R.keywords),templateType:a(R.templateType,50),frameworkStr:s(ne.value),content:a(ge.value.content,5e4),clientId:`client_${Date.now()}_${Math.random().toString(36).substring(2,10)}`};console.log("å¤„ç†åçš„å®‰å…¨æ•°æ®:",n),console.log("å¼€å§‹è°ƒç”¨åˆ›å»ºç ”ç©¶æ–¹æ¡ˆAPI...");const r=await J(n);console.log("ä¿å­˜æˆåŠŸï¼Œè¿”å›çš„å®Œæ•´æ–¹æ¡ˆæ•°æ®:",r),Object.keys(r).forEach((e=>{console.log(`è¿”å›å­—æ®µ[${e}]:`,r[e])}));let c=null;r&&r._id?(c=r._id,console.log("æˆåŠŸè·å–åˆ°æ–¹æ¡ˆID:",c)):r&&r.id?(c=r.id,console.log("ä½¿ç”¨æ›¿ä»£IDå­—æ®µ:",c)):(c=n.clientId,console.log("ä½¿ç”¨å®¢æˆ·ç«¯ç”Ÿæˆçš„å¤‡ç”¨ID:",c));try{let e=b("researchPlanHistory")||[];Array.isArray(e)||(e=[]),e.unshift({id:c,title:n.title,time:Date.now()}),e.length>10&&(e=e.slice(0,10)),w("researchPlanHistory",e),console.log("æ›´æ–°æ–¹æ¡ˆå†å²è®°å½•æˆåŠŸï¼Œå½“å‰å†å²:",e)}catch(e){console.error("ä¿å­˜æ–¹æ¡ˆå†å²è®°å½•å¤±è´¥:",e)}h(),_({title:"ä¿å­˜æˆåŠŸ",icon:"success"}),c&&setTimeout((()=>{console.log("å³å°†è·³è½¬åˆ°è¯¦æƒ…é¡µï¼ŒID:",c),x({url:`/pages/researchPlanDetail/researchPlanDetail?id=${encodeURIComponent(c)}`})}),1500)}catch(l){console.error("ä¿å­˜ç ”ç©¶æ–¹æ¡ˆå¤±è´¥:",l),h(),_({title:"ä¿å­˜å¤±è´¥: "+l.message,icon:"none"})}},Se=()=>{R.topic="",R.objective="",R.keywords=[],R.templateType="experimental",W.value="",K.value=0,ee.value=!1,ne.value=null,ge.value={content:"",framework:null},_e.value="",L.value=0},je=()=>{W.value.trim()&&(console.log("æ‰‹åŠ¨æ·»åŠ å…³é”®è¯:",W.value.trim()),R.keywords.push(W.value.trim()),W.value="",le(),_({title:"å…³é”®è¯å·²æ·»åŠ ",icon:"none",duration:1e3}))},Ie=e=>`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")} ${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}`;return o((()=>{console.log("ç ”ç©¶æ–¹æ¡ˆç”Ÿæˆå™¨ç»„ä»¶å·²æŒ‚è½½"),le(),ce.value||(console.warn("ç¼–è¾‘å¼¹çª—ç»„ä»¶æœªæ­£ç¡®åˆå§‹åŒ–"),setTimeout((()=>{ce.value||console.warn("ç¼–è¾‘å¼¹çª—ç»„ä»¶å»¶è¿Ÿåˆå§‹åŒ–ä»ç„¶å¤±è´¥")}),1e3)),console.log("åˆå§‹çŠ¶æ€:",{currentStep:L.value,formData:JSON.stringify(R),isFormValid:ee.value,templateTypeIndex:K.value,graphData:M.graphData?"å­˜åœ¨":"ä¸å­˜åœ¨"})})),t((()=>M.graphData),(e=>{U.value=null!==e})),(e,l)=>{const t=$,a=C,o=S,y=j,h=I,_=T,k=D,b=O,w=P,x=z(s("uni-popup"),N);return n(),r(t,{class:"research-plan-generator"},{default:c((()=>[i(t,{class:"steps-container"},{default:c((()=>[(n(),u(d,null,p(H,((e,l)=>i(t,{key:l,class:f(["step",{active:L.value>=l,complete:L.value>l}])},{default:c((()=>[i(t,{class:"step-number"},{default:c((()=>[m(g(l+1),1)])),_:2},1024),i(a,{class:"step-title"},{default:c((()=>[m(g(e.title),1)])),_:2},1024)])),_:2},1032,["class"]))),64))])),_:1}),i(t,{class:"step-content"},{default:c((()=>[0===L.value?(n(),r(t,{key:0,class:"step-form"},{default:c((()=>[i(t,{class:"form-group"},{default:c((()=>[i(a,{class:"form-label"},{default:c((()=>[m("ç ”ç©¶ä¸»é¢˜")])),_:1}),i(o,{class:"form-input",modelValue:R.topic,"onUpdate:modelValue":l[0]||(l[0]=e=>R.topic=e),placeholder:"è¯·è¾“å…¥ç ”ç©¶ä¸»é¢˜",onInput:le,onBlur:le},null,8,["modelValue"])])),_:1}),i(t,{class:"form-group"},{default:c((()=>[i(a,{class:"form-label"},{default:c((()=>[m("ç ”ç©¶ç›®æ ‡")])),_:1}),i(y,{class:"form-textarea",modelValue:R.objective,"onUpdate:modelValue":l[1]||(l[1]=e=>R.objective=e),placeholder:"è¯·æè¿°ç ”ç©¶ç›®æ ‡",onInput:le,onBlur:le},null,8,["modelValue"])])),_:1}),i(t,{class:"form-group"},{default:c((()=>[i(a,{class:"form-label"},{default:c((()=>[m("å…³é”®è¯ï¼ˆå¤šä¸ªå…³é”®è¯ä»¥é€—å·åˆ†éš”ï¼‰")])),_:1}),i(t,{class:"keyword-input-container"},{default:c((()=>[i(o,{class:"form-input",modelValue:W.value,"onUpdate:modelValue":l[2]||(l[2]=e=>W.value=e),placeholder:"ä¾‹å¦‚ï¼šæ•™è‚²æŠ€æœ¯,æ•°æ®æŒ–æ˜,äººå·¥æ™ºèƒ½",onInput:q,onBlur:G,onConfirm:X},null,8,["modelValue"]),i(h,{class:"add-keyword-btn",onClick:je,disabled:!W.value.trim()},{default:c((()=>[m(" æ·»åŠ  ")])),_:1},8,["disabled"])])),_:1}),i(t,{class:"keywords-container"},{default:c((()=>[(n(!0),u(d,null,p(R.keywords,((e,l)=>(n(),r(t,{key:l,class:"keyword-tag"},{default:c((()=>[i(a,null,{default:c((()=>[m(g(e),1)])),_:2},1024),i(a,{class:"remove-keyword",onClick:e=>(e=>{R.keywords.splice(e,1),le()})(l)},{default:c((()=>[m("Ã—")])),_:2},1032,["onClick"])])),_:2},1024)))),128))])),_:1})])),_:1}),i(t,{class:"form-group"},{default:c((()=>[i(a,{class:"form-label"},{default:c((()=>[m("ç ”ç©¶æ–¹æ¡ˆç±»å‹")])),_:1}),i(_,{class:"form-picker",range:Y,value:K.value,onChange:Z},{default:c((()=>[i(t,{class:"picker-text"},{default:c((()=>[m(g(K.value>=0?Y[K.value]:"è¯·é€‰æ‹©ç ”ç©¶æ–¹æ¡ˆç±»å‹"),1)])),_:1})])),_:1},8,["value"])])),_:1}),E.graphData?(n(),r(t,{key:0,class:"form-group"},{default:c((()=>[i(b,{class:"checkbox-container"},{default:c((()=>[i(k,{checked:U.value,onChange:te},null,8,["checked"]),i(a,{class:"checkbox-label"},{default:c((()=>[m("ä½¿ç”¨å·²ç”Ÿæˆçš„çŸ¥è¯†å›¾è°±æ•°æ®")])),_:1})])),_:1})])),_:1})):v("",!0),i(t,{class:"form-actions"},{default:c((()=>[i(h,{class:"primary-button",onClick:ae,disabled:!ee.value,"hover-class":"button-hover"},{default:c((()=>[m(" ä¸‹ä¸€æ­¥ï¼šç”Ÿæˆæ¡†æ¶ ")])),_:1},8,["disabled"])])),_:1})])),_:1})):v("",!0),1===L.value?(n(),r(t,{key:1,class:"step-framework"},{default:c((()=>[se.value?(n(),r(t,{key:0,class:"loading-container"},{default:c((()=>[i(t,{class:"loading-spinner"}),i(a,{class:"loading-text"},{default:c((()=>[m("æ­£åœ¨ç”Ÿæˆç ”ç©¶æ–¹æ¡ˆæ¡†æ¶...")])),_:1})])),_:1})):(n(),r(t,{key:1,class:"framework-content"},{default:c((()=>[i(a,{class:"section-title"},{default:c((()=>[m("ç ”ç©¶æ–¹æ¡ˆæ¡†æ¶")])),_:1}),ne.value.error?(n(),r(t,{key:0,class:"error-message"},{default:c((()=>[i(a,null,{default:c((()=>[m(g(ne.value.error),1)])),_:1}),i(h,{class:"retry-button",onClick:re},{default:c((()=>[m("é‡è¯•")])),_:1})])),_:1})):(n(),r(t,{key:1,class:"framework-sections"},{default:c((()=>[(n(!0),u(d,null,p(ne.value,((e,l)=>(n(),r(t,{key:l,class:"framework-section"},{default:c((()=>[i(t,{class:"section-header"},{default:c((()=>[i(a,{class:"section-name"},{default:c((()=>[m(g(e.title),1)])),_:2},1024),i(a,{class:"section-edit",onClick:e=>(e=>{ie.value=e,ue.value=ne.value[e].title,de.value=ne.value[e].description,ce.value.open()})(l)},{default:c((()=>[m("ç¼–è¾‘")])),_:2},1032,["onClick"])])),_:2},1024),i(a,{class:"section-description"},{default:c((()=>[m(g(e.description),1)])),_:2},1024)])),_:2},1024)))),128))])),_:1})),i(t,{class:"form-actions"},{default:c((()=>[i(h,{class:"secondary-button",onClick:oe},{default:c((()=>[m(" è¿”å›ä¸Šä¸€æ­¥ ")])),_:1}),i(h,{class:"primary-button",onClick:ae,disabled:!ne.value||ne.value.error},{default:c((()=>[m(" ä¸‹ä¸€æ­¥ï¼šç”Ÿæˆå®Œæ•´æ–¹æ¡ˆ ")])),_:1},8,["disabled"])])),_:1})])),_:1}))])),_:1})):v("",!0),2===L.value?(n(),r(t,{key:2,class:"step-complete-plan"},{default:c((()=>[me.value?(n(),r(t,{key:0,class:"loading-container"},{default:c((()=>[i(t,{class:"loading-spinner"}),i(a,{class:"loading-text"},{default:c((()=>[m("æ­£åœ¨ç”Ÿæˆå®Œæ•´ç ”ç©¶æ–¹æ¡ˆ...")])),_:1})])),_:1})):(n(),r(t,{key:1,class:"plan-content"},{default:c((()=>[i(a,{class:"section-title"},{default:c((()=>[m("å®Œæ•´ç ”ç©¶æ–¹æ¡ˆ")])),_:1}),ge.value.error?(n(),r(t,{key:0,class:"error-message"},{default:c((()=>[i(a,null,{default:c((()=>[m(g(ge.value.error),1)])),_:1}),i(h,{class:"retry-button",onClick:ve},{default:c((()=>[m("é‡è¯•")])),_:1})])),_:1})):(n(),r(t,{key:1,class:"plan-display",ref_key:"planDisplayRef",ref:xe},{default:c((()=>[i(t,{class:"plan-header"},{default:c((()=>[i(t,{class:"plan-title"},{default:c((()=>[m(g(R.topic),1)])),_:1}),i(t,{class:"plan-meta"},{default:c((()=>[i(a,null,{default:c((()=>[m("å…³é”®è¯: "+g(R.keywords.join("ã€")),1)])),_:1})])),_:1})])),_:1}),i(w,{nodes:ye.value},null,8,["nodes"]),i(t,{class:"plan-footer"},{default:c((()=>[i(a,null,{default:c((()=>[m("ç”Ÿæˆæ—¶é—´: "+g(Ie(new Date)),1)])),_:1}),i(a,null,{default:c((()=>[m("ç”±EduResearchæ™ºèƒ½æ•™è‚²ç ”ç©¶åŠ©æ‰‹ç”Ÿæˆ")])),_:1})])),_:1})])),_:1},512)),ge.value.content?(n(),r(t,{key:2,class:"optimization-controls"},{default:c((()=>[i(a,{class:"optimization-title"},{default:c((()=>[m("æ–¹æ¡ˆä¼˜åŒ–")])),_:1}),i(t,{class:"optimization-options"},{default:c((()=>[(n(),u(d,null,p(he,((e,l)=>i(t,{key:l,class:f(["optimization-option",{selected:_e.value===e.value}]),onClick:l=>{return t=e.value,void(_e.value=t);var t}},{default:c((()=>[i(a,null,{default:c((()=>[m(g(e.label),1)])),_:2},1024)])),_:2},1032,["class","onClick"]))),64))])),_:1}),i(h,{class:"optimize-button",onClick:be,disabled:!_e.value||ke.value},{default:c((()=>[m(g(ke.value?"æ­£åœ¨ä¼˜åŒ–...":"ä¼˜åŒ–æ–¹æ¡ˆ"),1)])),_:1},8,["disabled"])])),_:1})):v("",!0),ge.value.content?(n(),r(t,{key:3,class:"export-options"},{default:c((()=>[i(h,{class:"export-button",onClick:$e,disabled:we.value},{default:c((()=>[m(g(we.value?"å¯¼å‡ºä¸­...":"å¯¼å‡ºä¸ºPDF"),1)])),_:1},8,["disabled"]),i(h,{class:"save-button",onClick:Ce},{default:c((()=>[m(" ä¿å­˜åˆ°å†å²è®°å½• ")])),_:1})])),_:1})):v("",!0),i(t,{class:"form-actions"},{default:c((()=>[i(h,{class:"secondary-button",onClick:oe},{default:c((()=>[m(" è¿”å›ä¸Šä¸€æ­¥ ")])),_:1}),i(h,{class:"restart-button",onClick:Se},{default:c((()=>[m(" é‡æ–°å¼€å§‹ ")])),_:1})])),_:1})])),_:1}))])),_:1})):v("",!0)])),_:1}),i(x,{ref_key:"sectionEditPopup",ref:ce,type:"center"},{default:c((()=>[i(t,{class:"edit-popup-content"},{default:c((()=>[i(t,{class:"edit-popup-header"},{default:c((()=>[i(a,{class:"edit-popup-title"},{default:c((()=>[m("ç¼–è¾‘"+g(ie.value?ne.value[ie.value].title:""),1)])),_:1})])),_:1}),i(t,{class:"edit-popup-body"},{default:c((()=>[i(t,{class:"form-group"},{default:c((()=>[i(a,{class:"form-label"},{default:c((()=>[m("æ ‡é¢˜")])),_:1}),i(o,{class:"form-input",modelValue:ue.value,"onUpdate:modelValue":l[3]||(l[3]=e=>ue.value=e),placeholder:"è¾“å…¥ç« èŠ‚æ ‡é¢˜"},null,8,["modelValue"])])),_:1}),i(t,{class:"form-group"},{default:c((()=>[i(a,{class:"form-label"},{default:c((()=>[m("æè¿°")])),_:1}),i(y,{class:"form-textarea",modelValue:de.value,"onUpdate:modelValue":l[4]||(l[4]=e=>de.value=e),placeholder:"è¾“å…¥ç« èŠ‚æè¿°"},null,8,["modelValue"])])),_:1})])),_:1}),i(t,{class:"edit-popup-footer"},{default:c((()=>[i(h,{class:"cancel-button",onClick:pe},{default:c((()=>[m("å–æ¶ˆ")])),_:1}),i(h,{class:"confirm-button",onClick:fe},{default:c((()=>[m("ä¿å­˜")])),_:1})])),_:1})])),_:1})])),_:1},512)])),_:1})}}},[["__scopeId","data-v-1ce69ed5"]]),H=V({__name:"researchPlan",setup(l){const t=e(!1),a=e(""),s=e(null),u=()=>{E({delta:1})},d=e=>{x({url:`/pages/${e}/${e}`})},p=e=>{console.log("æ–¹æ¡ˆç”Ÿæˆå®Œæˆ:",e)},f=()=>{console.log("æ–¹æ¡ˆç”Ÿæˆå·²å–æ¶ˆ")};return o((()=>{(()=>{try{const e=b("isLogIn"),l=b("username");e&&l?(t.value=!0,a.value=l):(t.value=!1,a.value="")}catch(e){console.error("æ£€æŸ¥ç™»å½•çŠ¶æ€æ—¶å‡ºé”™:",e),t.value=!1,a.value=""}})(),(()=>{try{const e=b("lastGraphData");e&&(s.value=JSON.parse(e))}catch(e){console.error("åŠ è½½çŸ¥è¯†å›¾è°±æ•°æ®æ—¶å‡ºé”™:",e),s.value=null}})()})),(e,l)=>{const o=C,v=$;return n(),r(v,{class:"research-plan-page"},{default:c((()=>[i(v,{class:"header"},{default:c((()=>[i(v,{class:"back-button",onClick:u},{default:c((()=>[i(o,{class:"back-icon"},{default:c((()=>[m("â†")])),_:1}),i(o,{class:"back-text"},{default:c((()=>[m("è¿”å›")])),_:1})])),_:1}),i(o,{class:"logo"},{default:c((()=>[m("EduResearch")])),_:1}),t.value?(n(),r(v,{key:1,class:"user-info"},{default:c((()=>[i(o,null,{default:c((()=>[m(g(a.value),1)])),_:1})])),_:1})):(n(),r(v,{key:0,class:"nav-btns"},{default:c((()=>[i(o,{class:"nav-btn",onClick:l[0]||(l[0]=e=>d("logIn"))},{default:c((()=>[m("ç™»å½•")])),_:1}),i(o,{class:"nav-btn primary",onClick:l[1]||(l[1]=e=>d("enroll"))},{default:c((()=>[m("æ³¨å†Œ")])),_:1})])),_:1}))])),_:1}),i(v,{class:"main-content"},{default:c((()=>[i(v,{class:"page-title"},{default:c((()=>[i(o,{class:"title-text"},{default:c((()=>[m("ç ”ç©¶æ–¹æ¡ˆç”Ÿæˆ")])),_:1}),i(o,{class:"subtitle-text"},{default:c((()=>[m("åŸºäºé¢†åŸŸç»“æ„åŒ–çŸ¥è¯†é©±åŠ¨çš„æ•™å­¦ç ”ç©¶æ–¹æ¡ˆç”Ÿæˆç³»ç»Ÿ")])),_:1})])),_:1}),i(v,{class:"feature-description"},{default:c((()=>[i(v,{class:"feature-card"},{default:c((()=>[i(v,{class:"feature-icon"},{default:c((()=>[m("ğŸ“")])),_:1}),i(v,{class:"feature-info"},{default:c((()=>[i(o,{class:"feature-title"},{default:c((()=>[m("è‡ªåŠ¨ç”Ÿæˆç ”ç©¶æ¡†æ¶")])),_:1}),i(o,{class:"feature-desc"},{default:c((()=>[m("æ ¹æ®ç ”ç©¶ä¸»é¢˜å’Œç›®æ ‡ï¼Œè‡ªåŠ¨ç”Ÿæˆç¬¦åˆå­¦æœ¯è§„èŒƒçš„ç ”ç©¶æ–¹æ¡ˆæ¡†æ¶")])),_:1})])),_:1})])),_:1}),i(v,{class:"feature-card"},{default:c((()=>[i(v,{class:"feature-icon"},{default:c((()=>[m("ğŸ”")])),_:1}),i(v,{class:"feature-info"},{default:c((()=>[i(o,{class:"feature-title"},{default:c((()=>[m("æ™ºèƒ½å¡«å……ç ”ç©¶å†…å®¹")])),_:1}),i(o,{class:"feature-desc"},{default:c((()=>[m("åŸºäºæ¡†æ¶ç»“æ„ï¼Œæ™ºèƒ½ç”Ÿæˆç ”ç©¶æ–¹æ³•ã€æ•°æ®æ”¶é›†å’Œåˆ†ææ–¹æ¡ˆ")])),_:1})])),_:1})])),_:1}),i(v,{class:"feature-card"},{default:c((()=>[i(v,{class:"feature-icon"},{default:c((()=>[m("ğŸ“Š")])),_:1}),i(v,{class:"feature-info"},{default:c((()=>[i(o,{class:"feature-title"},{default:c((()=>[m("ç»“åˆçŸ¥è¯†å›¾è°±æ•°æ®")])),_:1}),i(o,{class:"feature-desc"},{default:c((()=>[m("åˆ©ç”¨çŸ¥è¯†å›¾è°±æ•°æ®ï¼Œå¢å¼ºç ”ç©¶æ–¹æ¡ˆçš„ç§‘å­¦æ€§å’Œç³»ç»Ÿæ€§")])),_:1})])),_:1})])),_:1})])),_:1}),i(M,{"graph-data":s.value,embedded:!1,onComplete:p,onCancel:f},null,8,["graph-data"])])),_:1}),i(v,{class:"footer"},{default:c((()=>[i(o,null,{default:c((()=>[m("è®©æ•™è‚²ç ”ç©¶æ›´é«˜æ•ˆ Â© 2024")])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-3e90d92b"]]);export{H as default};
