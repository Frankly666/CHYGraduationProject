import{m as e,r as a,c as s,w as l,i as t,o as n,a as o,p as r,b as u,s as d,q as i,v as c,x as m,h as p,n as f,j as g,I as _,y as w}from"./index-E3agI9Tn.js";import{_ as v}from"./_plugin-vue_export-helper.BCo6x5W8.js";const y=v({__name:"logIn",setup(v){const y=a(!1),h=a({username:"",password:""}),b=async()=>{if(h.value.username&&h.value.password)if(h.value.username.length<6||h.value.password.length<6)d({title:"账号和密码长度不能小于6位",icon:"none",duration:2e3});else try{y.value=!0,i({title:"登录中...",mask:!0});const a=await(async a=>{try{return(await e.callFunction({name:"login",data:{username:a.username,password:a.password}})).result}catch(s){return console.error("调用云函数失败:",s),{code:500,message:"登录失败，请稍后重试"}}})(h.value);c(),200===a.code?(m("username",a.data.username),m("encryptedPassword",a.data.encryptedPassword),m("salt",a.data.salt),m("isLogIn","true"),m("userId",a.data._id),d({title:"登录成功",icon:"success",duration:1500}),setTimeout((()=>{p({url:"/pages/index/index"})}),1500)):d({title:a.message||"登录失败",icon:"none",duration:2e3})}catch(a){c(),d({title:"登录失败，请稍后重试",icon:"none",duration:2e3}),console.error("登录失败:",a)}else d({title:"账号和密码不能为空",icon:"none",duration:2e3})};function k(){f({url:"/pages/enroll/enroll"})}return(e,a)=>{const d=g,i=t,c=_,m=w;return n(),s(i,{class:"w3l-workinghny-form"},{default:l((()=>[o(i,{class:"wrapper"},{default:l((()=>[o(i,{class:"logo"},{default:l((()=>[r("h1",null,[o(d,{class:"brand-logo",href:"#"},{default:l((()=>[u(" 教学方案研究生成系统 ")])),_:1})])])),_:1}),o(i,{class:"workinghny-block-grid"},{default:l((()=>[o(i,{class:"workinghny-left-img"},{default:l((()=>[r("img",{src:"/assets/2-WARUgmsW.png",class:"img-responsive",alt:"login visual"})])),_:1}),o(i,{class:"form-right-inf"},{default:l((()=>[o(i,{class:"login-form-content"},{default:l((()=>[o(i,{class:"signin-form"},{default:l((()=>[o(i,{class:"one-frm"},{default:l((()=>[o(i,null,{default:l((()=>[u("账号")])),_:1}),o(c,{type:"text",placeholder:"请输入账号名",modelValue:h.value.username,"onUpdate:modelValue":a[0]||(a[0]=e=>h.value.username=e)},null,8,["modelValue"])])),_:1}),o(i,{class:"one-frm"},{default:l((()=>[o(i,null,{default:l((()=>[u("密码")])),_:1}),o(c,{type:"password",modelValue:h.value.password,"onUpdate:modelValue":a[1]||(a[1]=e=>h.value.password=e),placeholder:"请输入你的密码"},null,8,["modelValue"])])),_:1}),o(m,{type:"submit",class:"btn btn-style mt-3",onClick:b,disabled:y.value},{default:l((()=>[y.value?(n(),s(d,{key:1,class:"loading-text"},{default:l((()=>[u("登录中...")])),_:1})):(n(),s(d,{key:0},{default:l((()=>[u("登录")])),_:1}))])),_:1},8,["disabled"]),r("p",{class:"already"},[u(" 还没有账号? "),r("a",{onClick:k},"注册")])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-a0f52ab3"]]);export{y as default};
