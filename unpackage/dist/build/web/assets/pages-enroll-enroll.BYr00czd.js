import{m as e,r as a,c as l,w as s,i as o,o as n,a as t,p as r,b as u,s as d,q as i,v as c,x as m,n as f,j as p,I as g,y as _}from"./index-BF_XYmBj.js";import{_ as v}from"./_plugin-vue_export-helper.BCo6x5W8.js";const w=v({__name:"enroll",setup(v){const w=a(!1),y=a({username:"",password:"",confirmPassword:""}),h=async()=>{if(y.value.username&&y.value.password&&y.value.confirmPassword)if(y.value.password===y.value.confirmPassword)if(y.value.username.length<6||y.value.password.length<6)d({title:"账号和密码长度不能小于6位",icon:"none",duration:2e3});else try{w.value=!0,i({title:"注册中...",mask:!0});const a=await(async a=>{try{return(await e.callFunction({name:"enroll",data:{username:a.username,password:a.password}})).result}catch(l){return console.error("调用云函数失败:",l),{code:500,message:"注册失败，请稍后重试"}}})(y.value);c(),200===a.code?(d({title:"注册成功",icon:"success",duration:1500}),a.data&&a.data.userId&&m("userId",a.data.userId),setTimeout((()=>{f({url:"/pages/logIn/logIn"})}),1500)):d({title:a.message||"注册失败",icon:"none",duration:2e3})}catch(a){c(),d({title:"注册失败，请稍后重试",icon:"none",duration:2e3}),console.error("注册失败:",a)}finally{w.value=!1}else d({title:"两次输入的密码不一致",icon:"none",duration:2e3});else d({title:"账号和密码不能为空",icon:"none",duration:2e3})};function b(){f({url:"/pages/logIn/logIn"})}return(e,a)=>{const d=p,i=o,c=g,m=_;return n(),l(i,{class:"w3l-workinghny-form"},{default:s((()=>[t(i,{class:"wrapper"},{default:s((()=>[t(i,{class:"logo"},{default:s((()=>[r("h1",null,[t(d,{class:"brand-logo",href:"#"},{default:s((()=>[u(" 教学方案研究生成系统 ")])),_:1})])])),_:1}),t(i,{class:"workinghny-block-grid"},{default:s((()=>[t(i,{class:"workinghny-left-img"},{default:s((()=>[r("img",{src:"/assets/1-xj8D26KL.png",class:"img-responsive",alt:"login visual"})])),_:1}),t(i,{class:"form-right-inf"},{default:s((()=>[t(i,{class:"login-form-content"},{default:s((()=>[t(i,{class:"signin-form"},{default:s((()=>[t(i,{class:"one-frm"},{default:s((()=>[t(i,null,{default:s((()=>[u("账号")])),_:1}),t(c,{type:"text",placeholder:"请输入账号名",modelValue:y.value.username,"onUpdate:modelValue":a[0]||(a[0]=e=>y.value.username=e)},null,8,["modelValue"])])),_:1}),t(i,{class:"one-frm"},{default:s((()=>[t(i,null,{default:s((()=>[u("密码")])),_:1}),t(c,{type:"password",modelValue:y.value.password,"onUpdate:modelValue":a[1]||(a[1]=e=>y.value.password=e),placeholder:"请输入你的密码"},null,8,["modelValue"])])),_:1}),t(i,{class:"one-frm"},{default:s((()=>[t(i,null,{default:s((()=>[u("确认密码")])),_:1}),t(c,{type:"password",modelValue:y.value.confirmPassword,"onUpdate:modelValue":a[2]||(a[2]=e=>y.value.confirmPassword=e),placeholder:"再次输入你的密码"},null,8,["modelValue"])])),_:1}),t(m,{type:"submit",class:"btn btn-style mt-3",onClick:h,disabled:w.value},{default:s((()=>[w.value?(n(),l(d,{key:1,class:"loading-text"},{default:s((()=>[u("注册中...")])),_:1})):(n(),l(d,{key:0},{default:s((()=>[u("注册")])),_:1}))])),_:1},8,["disabled"]),r("p",{class:"already"},[u(" 已有账号? "),r("a",{onClick:b},"登录")])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-ab74cfa8"]]);export{w as default};
